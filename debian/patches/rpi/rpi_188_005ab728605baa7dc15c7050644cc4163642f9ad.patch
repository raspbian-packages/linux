commit 005ab728605baa7dc15c7050644cc4163642f9ad
Author: popcornmix <popcornmix@gmail.com>
Date:   Fri Jul 13 18:34:18 2012 +0100

    Add temporary fix for hang when quitting X

Index: linux-3.2.46/drivers/video/bcm2708_fb.c
===================================================================
--- linux-3.2.46.orig/drivers/video/bcm2708_fb.c	2013-07-26 19:33:49.000000000 +0000
+++ linux-3.2.46/drivers/video/bcm2708_fb.c	2013-07-26 19:34:03.000000000 +0000
@@ -18,6 +18,7 @@
 #include <linux/errno.h>
 #include <linux/string.h>
 #include <linux/slab.h>
+#include <linux/delay.h>
 #include <linux/mm.h>
 #include <linux/fb.h>
 #include <linux/init.h>
@@ -221,7 +222,9 @@
 	/* inform vc about new framebuffer */
 	bcm_mailbox_write(MBOX_CHAN_FB, fb->dma);
 
-	/* TODO: replace fb driver with vchiq version */
+	/* workaround occasional failure to read results. TODO: fix */
+	msleep(10);
+
 	/* wait for response */
 	bcm_mailbox_read(MBOX_CHAN_FB, &val);
 
