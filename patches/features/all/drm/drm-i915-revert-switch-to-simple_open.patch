From eb5a32214c4f95bbceaf481a53289086274b7275 Mon Sep 17 00:00:00 2001
From: Julien Cristau <jcristau@debian.org>
Date: Wed, 22 Aug 2012 18:54:53 +0200
Subject: [PATCH 1/7] drm/i915: revert switch to simple_open

This reverts part of commit 234e340582901211f40d8c732afc49f0630ecf05
---
 drivers/gpu/drm/i915/i915_debugfs.c |   14 +++++++++++---
 1 file changed, 11 insertions(+), 3 deletions(-)

Index: linux-3.2.46/drivers/gpu/drm/i915/i915_debugfs.c
===================================================================
--- linux-3.2.46.orig/drivers/gpu/drm/i915/i915_debugfs.c	2013-07-26 19:26:22.000000000 +0000
+++ linux-3.2.46/drivers/gpu/drm/i915/i915_debugfs.c	2013-07-26 19:26:55.000000000 +0000
@@ -1505,6 +1505,14 @@
 	return 0;
 }
 
+static int
+i915_debugfs_common_open(struct inode *inode,
+			 struct file *filp)
+{
+	filp->private_data = inode->i_private;
+	return 0;
+}
+
 static ssize_t
 i915_wedged_read(struct file *filp,
 		 char __user *ubuf,
@@ -1555,7 +1563,7 @@
 
 static const struct file_operations i915_wedged_fops = {
 	.owner = THIS_MODULE,
-	.open = simple_open,
+	.open = i915_debugfs_common_open,
 	.read = i915_wedged_read,
 	.write = i915_wedged_write,
 	.llseek = default_llseek,
@@ -1617,7 +1625,7 @@
 
 static const struct file_operations i915_max_freq_fops = {
 	.owner = THIS_MODULE,
-	.open = simple_open,
+	.open = i915_debugfs_common_open,
 	.read = i915_max_freq_read,
 	.write = i915_max_freq_write,
 	.llseek = default_llseek,
@@ -1688,7 +1696,7 @@
 
 static const struct file_operations i915_cache_sharing_fops = {
 	.owner = THIS_MODULE,
-	.open = simple_open,
+	.open = i915_debugfs_common_open,
 	.read = i915_cache_sharing_read,
 	.write = i915_cache_sharing_write,
 	.llseek = default_llseek,
